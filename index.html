
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>KVSS II 인지검사</title>
</head>
<body>
  <h1>KVSS II 인지검사</h1>
  <form id="kvssForm">
    <label>이름: <input type="text" name="patientName" required /></label><br/>
    <label>병록번호: <input type="text" name="patientId" required /></label><br/><br/>

    <div id="questionsContainer"></div>

    <button type="submit">제출</button>
  </form>

  <script>
    const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwGUBgeq7STISIf_7fJZcu4vL7iSgnqU4YeXrB5YFRzg5taeCYrR9-kQ-u5i8Ur7iWW/exec";

    const questions = [
      "Q1", "Q2", "Q3", "Q4", "Q5", "Q6", "Q7", "Q8",
      "Q9", "Q10", "Q11", "Q12", "Q13", "Q14", "Q15", "Q16"
    ];

    const exampleOptions = ["오런제", "가죽", "바닐라", "페퍼민트", "바나나", "레몬", "감초", "송진", "마늘", "커피", "사과", "간장", "파인애플", "장미", "참기름", "생선"];

    const questionsContainer = document.getElementById("questionsContainer");

    questions.forEach((q, i) => {
      const container = document.createElement("div");
      container.innerHTML = `
        <p>${q}</p>
        <select name="q${i+1}" required>
          <option value="">선택하세요</option>
          ${exampleOptions.map(opt => `<option value="${opt}">${opt}</option>`).join("")}
        </select>
      `;
      questionsContainer.appendChild(container);
    });

    document.getElementById("kvssForm").addEventListener("submit", function(e) {
      e.preventDefault();

      const form = e.target;
      const data = {
        patientName: form.patientName.value,
        patientId: form.patientId.value,
        answers: questions.map((q, i) => ({
          questionNumber: i + 1,
          selectedOption: form[`q${i+1}`].value
        }))
      };

      fetch(GOOGLE_SCRIPT_URL, {
        method: "POST",
        body: JSON.stringify(data)
      })
      .then(res => res.text())
      .then(result => {
        alert("제출 완료: " + result);
      })
      .catch(error => {
        alert("오류 발생: " + error);
      });
    });
  </script>
</body>
</html>
